{"version":3,"sources":["Debugger.tsx","StatLoader.tsx","stats.ts","DataTable.tsx","StatSelector.tsx","Table.tsx","particle-factory.ts","player.ts","env.ts","Game.tsx","App.tsx","reportWebVitals.js","index.js"],"names":["Debugger","env","damage_to","player","damage","players","take_damage","update_game_state","className","onClick","json","require","columns","Object","fromEntries","keys","map","k","name","params","split","out","undefined","x","bigger_is_better","JSON","parse","data","obj","fun","v","entries","stats_with_metadata","dfd","Normalizer","multipliers","col","target","mean","multiplier","Math","round","log10","adjusts","errors","adjust","abs","argMin","this","column_names","n_decimals","floor","mul","transform_stats_in_attributes","stats","stats_to_attributes","attributes","converted_player","to","from","Error","stringify","push","normalizer","df","window","damage_per_ball","normalize_stat","max_health","balls_per_second","values","row","zip_key_vals","normalize","vals","rv","i","length","compareFn","max","el","array","idx","reduce","DataTable","useTable","getTableProps","getTableBodyProps","headerGroups","rows","prepareRow","striped","bordered","hover","headerGroup","getHeaderGroupProps","headers","column","getHeaderProps","render","getRowProps","cells","cell","getCellProps","StatSelector","all_stats","filtered_stats","set_filtered_stats","is_simulating","set_is_simulating","useRef","teams","value","label","ano_campeonato","time","update_parent_state","current","p","c","Header","accessor","style","maxWidth","isMulti","isDisabled","onChange","e","Array","options","Button","overflowY","game_state_columns","Cell","GameStateCell","mount_columns","attribute","stat","multiplier_str","toPrecision","attribute_label","attribute_labels","mount_column","Table","game_state","start_time","all_columns","useMemo","splice","final_data","rank","arr","sorted","Set","sort","a","b","Map","get","_rank_duplicate","died_at","getTime","Infinity","clone","game","died_at_string","toFixed","mount_final_data","div","old_v","useEffect","setTimeout","ref","ParticleEmitterFactory","particle_factory","y","opts","Emitter","owner","particlesAdded","pos","running","defaults","collisions","isStatic","size","min","amount","interval","velocity","direction","colors","delay","frictionAir","parent","collisionFilter","amountPerTick","decaySpeed","dir","toLowerCase","requestAnimationFrame","addParticle","duplicated","emitter","posX","posY","engine","timing","timeScale","pSize","vel","number","interactive","numParticles","position","angle","random","PI","dist","circleRadius","cos","sin","bounds","color","r","g","particle_opts","friction","frictionStatic","inertia","particle","Bodies","polygon","isSensor","density","restitution","restituition","fillStyle","isParticle","particles","Composite","add","world","velX","velY","Boolean","Body","setVelocity","scale","decreaseScale","remove","waitForInterval","framesPast","runner","fps","innerWidth","innerHeight","pallete","Color","Player","shape","health","damage_dealt","original_color","_build_shape","string","strokeStyle","lineWidth","collision_filter","rectangle","category","mask","group","create","start","die","health_percentage","alpha","console","log","stop","Date","Matter","Resolver","_restingThresh","_restingThreshTangent","clear","Env","game_state_callback","H","W","walls","title","for","Engine","velocityIterations","gravity","element_id","player_stats","Render","element","document","getElementById","width","height","wireframes","showDebug","showAngleIndicator","run","Runner","add_mouse_control","build_players","register_events","lookAt","mouse","Mouse","canvas","mouseConstraint","MouseConstraint","constraint","stiffness","visible","Events","on","event","mousePosition","n","0","1","max_idx","max_mag","mag","Vector","magnitudeSquared","sub","find_largest_line","vertices","v0","v1","perp","normalise","middle","mult","build_play_field","forEach","p_stats","get_player_coords","build_emitter","n_players","radius","smaller","bigger","ip1","sides","fromVertices","offset","translate","pairs","filter","_","bodyA","bodyB","pair","player_shape","other_shape","explode","Game","useState","set_game_state","set_start_time","rebuild_canvas","destroy","id","innerHTML","setup","App","path","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode"],"mappings":"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","file":"static/js/main.d41f4b7f.chunk.js","sourcesContent":["import { Env } from \"./env\"\n\nexport default function Debugger({env}: {env: Env}) {\n    function damage_to(player, damage) {\n        env.players[player].take_damage(damage)\n        env.update_game_state()\n    }\n    return (\n        <div>\n            <h1>DEBUG MODE ON!</h1>\n            <div>\n            <button className=\"btn btn-danger\" onClick={() => damage_to(0, 20)}> Damage p0 </button>\n            <button className=\"btn btn-danger\" onClick={() => damage_to(1, 20)}> Damage p1 </button>\n            </div>\n        </div>\n    )\n}","// import {Stats} from './App'\nimport * as dfd from \"danfojs/src/index\"\n\nfunction obj_map(obj, fun) {\n    return Object.fromEntries(Object.entries(obj).map(fun))\n}\n\nlet json = require(\"./brasileirao_stats.json\");\nlet columns = Object.fromEntries(Object.keys(json[0]).map(k => {\n    let name, params\n    [name, ...params] = k.split('|')\n    let out = {name: name}\n    params = Object.fromEntries(params.map(x=>x.split('=')))\n    if(params.bigger_is_better !== undefined)\n        params.bigger_is_better = JSON.parse(params.bigger_is_better)\n    return [k, {...out, ...params}]\n})\n)\n\nlet data = json.map(player => obj_map(player, ([k, v]) => [columns[k].name, v]))\ndata = new dfd.DataFrame(data)\n\nvar stats_with_metadata = {data: data, columns: columns}\n// var stats: Stats = [\n//     { team: 'Vasco', goals: 52, victories: 22 },\n//     { team: 'Botafogo', goals: 65, victories: 22},\n// ]\n\nexport default stats_with_metadata","import * as dfd from \"danfojs/src/index\"\nimport {Attributes} from './App'\n\nexport class Normalizer {\n    multipliers : {[key: string]: number} = {}\n    normalize_stat(col: dfd.Series, target) : dfd.Series {\n        let mean = col.mean()\n        let multiplier = 10 ** Math.round(Math.log10(target / mean))\n        let adjusts = [0.2, 0.5, 1, 2, 5]\n        let errors = adjusts.map( (adjust) => \n            Math.abs(target - (mean * multiplier * adjust))) // to think: treat errors in log?\n        //if(target === 33) { debugger}\n        multiplier *= adjusts[argMin(errors)]\n        this.multipliers[col.column_names] = multiplier\n        const n_decimals = 2 - Math.floor(Math.log10(target)) + 1 //TODO: test this better \n        return col.mul(multiplier).round(n_decimals)\n    }\n}\n\nexport function transform_stats_in_attributes(stats : Object[], stats_to_attributes: Object) : [Attributes, {[key: string]: number}] {\n    let attributes : Object[] = []\n    for (let player of stats){\n        let converted_player = {}\n        for (let to in stats_to_attributes){\n            let from = stats_to_attributes[to]\n            if(player[from] === undefined) throw new Error(`${from} not found in stats: ${JSON.stringify(player)}`);\n            \n            converted_player[to] = player[from]\n        }\n        attributes.push(converted_player)\n    }\n    return normalize(attributes)\n}\nfunction normalize(attributes) : [Attributes, {[key: string]: number}] {\n    let normalizer = new Normalizer()\n    let df = new dfd.DataFrame(attributes)\n    // @ts-ignore\n    window.df = df\n    let out\n    out = {\n        damage_per_ball: normalizer.normalize_stat(df.damage_per_ball, 20)\n        ,max_health: normalizer.normalize_stat(df.max_health, 100)\n        ,balls_per_second: normalizer.normalize_stat(df.balls_per_second, 1)\n        ,name: df.name\n    }\n    for(let k in out) {out[k] = out[k].values}\n    out = (new dfd.DataFrame(out))\n    let columns = out.columns\n    out = out.values //array of arrays\n    out = out.map(row => zip_key_vals(columns, row))\n    return [out as Attributes, normalizer.multipliers]\n}\n\nexport function dfToNative(df){\n    return df.values.map(row => zip_key_vals(df.columns, row))\n}\n\nfunction zip_key_vals(keys, vals) {\n  var rv = {};\n  for (var i = 0; i < keys.length; ++i)\n    rv[keys[i]] = vals[i];\n  return rv;\n}\n\n\n\n\nconst argFact = (compareFn) => (array) => array.map((el, idx) => [el, idx]).reduce(compareFn)[1]\n//const argMax = argFact((min, el) => (el[0] > min[0] ? el : min))\nconst argMin = argFact((max, el) => (el[0] < max[0] ? el : max))","import BTable from 'react-bootstrap/Table';\nimport { useTable } from 'react-table';\n\n\nexport function DataTable({ columns, data }) {\n    const {\n        getTableProps,\n        getTableBodyProps,\n        headerGroups,\n        rows,\n        prepareRow\n    } = useTable({ columns, data });\n    return (\n        <BTable {...getTableProps()} striped bordered hover>\n            <thead>\n                {headerGroups.map(headerGroup => (\n                    <tr {...headerGroup.getHeaderGroupProps()}>\n                        {headerGroup.headers.map(column => (\n                            <th {...column.getHeaderProps()}>\n                                {column.render('Header')}\n                            </th>\n                        ))}\n                    </tr>\n                ))}\n            </thead>\n            <tbody {...getTableBodyProps()}>\n                {rows.map(row => {\n                    prepareRow(row);\n                    return (\n                        <tr {...row.getRowProps()}>\n                            {row.cells.map(cell => {\n                                return (\n                                    <td {...cell.getCellProps()}>\n                                        {cell.render('Cell')}\n                                    </td>\n                                );\n                            })}\n                        </tr>\n                    );\n                })}\n            </tbody>\n        </BTable>\n    );\n}\n","import Select from 'react-select'\nimport Button from 'react-bootstrap/Button'\nimport { dfToNative } from './stats'\nimport { useRef, } from 'react'\nimport { Stats } from './App'\nimport { DataTable } from \"./DataTable\"\n\nexport default function StatSelector({all_stats, filtered_stats, set_filtered_stats,\n        is_simulating, set_is_simulating}){\n    let players : any = useRef([])\n    all_stats = dfToNative(all_stats)\n    let teams = all_stats.map((x, idx) => ({value: idx, label: `${x.ano_campeonato}/${x.time}`}))\n    function update(e){\n        if(! (e instanceof Array) )\n            e = []\n        players.current = e.map(x => x.value)\n        update_parent_state()\n    }\n    function update_parent_state() {\n        if(players.current.length < 2) return\n        let out: Stats = []\n        for (let p of players.current)\n            out.push(all_stats[p])\n        set_filtered_stats(out)\n    }\n    function reset(){\n        set_is_simulating(false)\n    }\n    function go() {\n        update_parent_state()\n        set_is_simulating(true)\n    }\n    let columns = filtered_stats ? Object.keys(filtered_stats[0]).map(c => ({Header: c, accessor: c})) : null\n    return (\n        <div className='container'>\n        <div className='row'>\n            <div className='col-4' style={{ maxWidth: \"3000px\" }}>\n                <div> Select players:\n                    <Select name=\"Players\" isMulti isDisabled={is_simulating} onChange={update} options={teams}/>\n                </div>\n                {is_simulating ? <Button onClick={reset}> RESET </Button> : null}\n                {players.current.length >= 2 && !is_simulating ? <Button onClick={go}> Start Simulation </Button> : null}\n            </div>\n            <div className='col' style={{overflowY: 'scroll'}}>\n                {   columns\n                    ? <DataTable columns={columns} data={filtered_stats} />\n                    : null\n                }\n            </div>\n        </div>\n        </div>\n    )\n}","import {Column} from 'react-table'\nimport {useEffect, useMemo, useRef} from 'react'\nimport {Attributes, attribute_labels} from './App'\nimport clone from 'just-clone'\nimport { DataTable } from './DataTable'\n\nconst game_state_columns = [\n    { Header: 'Health', accessor: 'game.health', Cell: GameStateCell},\n    { Header: 'Died at', accessor: 'game.died_at_string', Cell: GameStateCell},\n    { Header: 'Rank', accessor: 'game.rank', Cell: GameStateCell},\n    { Header: 'Damage Dealt', accessor: 'game.damage_dealt', Cell: GameStateCell},\n]\n\n\n//type Column = {Header?: string , accessor: string, stat_formula?: string, attribute_label?: string }\n\nfunction mount_column(attribute, stat, multiplier ): Column {\n    let multiplier_str = multiplier ? ` x ${multiplier<1 ? multiplier.toPrecision(1): multiplier}` : ''\n    return {\n        Header: Header({\n            attribute_label: `${attribute_labels[attribute]}`,\n            stat: stat,\n            multiplier_str: multiplier_str\n        }),\n        Cell: Cell,\n        accessor: attribute\n    }\n}\nfunction mount_columns(attributes: Attributes, stats_to_attributes, multipliers) : Column[] {\n    return Object.entries(stats_to_attributes).map(([k, _]) => {\n        return mount_column(k, stats_to_attributes[k], multipliers[k])\n    })\n}\n\nexport function Table({stats, attributes, stats_to_attributes, game_state,\n        start_time, multipliers}) {\n    let all_columns = useMemo( () => {\n        const columns = mount_columns(attributes, stats_to_attributes, multipliers)\n        return [columns[0], ...game_state_columns, ...columns.splice(1) ] // putting name first\n    }, [attributes, multipliers, stats_to_attributes])\n\n    let final_data = useMemo(() => mount_final_data(game_state, attributes, start_time), [game_state, attributes, start_time])\n\n    //return <div><p>{JSON.stringify(stats)}</p><p>{JSON.stringify(columns)}</p></div>\n    // return (<BTable>\n    //         <thead>{JSON.stringify(stats)}\n    //     <tr {...columns}/></thead></BTable>)\n\n   return <DataTable columns={all_columns} data={final_data}/>\n}\n\nfunction Cell({column, row, value, cell}){\n    return ( <div className=''> {value} </div>)\n}\nfunction GameStateCell({column, row, value, cell}){\n    let div : any = useRef(null)\n    let old_v = useRef(value)\n    useEffect(() =>{\n        if (old_v.current !== value) {\n            div.current.className = ''\n            setTimeout(()=>{\n                div.current.className = 'color-animation'\n            }, 30)\n        }\n        old_v.current = value\n    })\n    return ( <div className='' ref={div}> {value} </div>)\n}\nfunction Header({attribute_label, stat, multiplier_str}){\n    let out = (\n        <div className=\"px-0 mx-0 text-nowrap\">\n            <span className=\"pr-0 flex-grow-0 \"> {/* attribute */}\n                {attribute_label}\n            </span>\n            <span className=\"pl-0 flex-grow-0\"> {/* formula */}\n                <span className=\"font-weight-light\">\n                    <span> {\" = \"} </span>\n                    <span className=\"text-info font-weight-bold\" >{stat}</span>\n                    <span>{multiplier_str}</span>\n                </span>\n            </span>\n        </div>\n    )\n    return out\n}\n\nfunction mount_final_data(game_state, attributes, start_time){\n    if(game_state === null) {// game hasn't started\n        return attributes\n    }\n\n    let rank = _rank_duplicate(game_state.map((x) => x.died_at !== null ? x.died_at.getTime() : Infinity))\n    let final_data = clone(attributes)\n    for (var i=0; i < final_data.length; i++) {\n        final_data[i].game = {...game_state[i]}\n        if(final_data[i].game.died_at !== null)\n            final_data[i].game.died_at_string = ((final_data[i].game.died_at - start_time)/1000).toFixed(1) + 's'\n        if(rank !== null)\n            final_data[i].game.rank = rank[i]\n    }\n    return final_data\n\n}\n\n\nfunction _rank_duplicate(arr: number[]) {\n    const sorted = [...new Set(arr)].sort((a: number, b: number) => b - a);\n    const rank = new Map(sorted.map((x, i) => [x, i + 1]));\n    return arr.map((x) => rank.get(x) as number);\n}","/* eslint no-unused-vars: \"off\" */\nimport { Bodies, Body, Composite,} from 'matter-js'\nimport { Env } from './env'\nimport Player from './player'\n\n// import ball from './sprites/ball.png'\n// function get_pattern(){\n//     var canvas : any = document.getElementById('canvas')?.children[0]\n//     var ctx = canvas.getContext('2d');\n//     let img = new Image()\n//     img.src = ball\n//     return ctx.createPattern(img, 'repeat');\n// }\n\ndeclare module 'matter-js' {\n  interface Body {\n    isParticle: boolean\n    decaySpeed: number\n  }\n  interface Runner {\n    fps: any\n  }\n}\n\n\nexport class ParticleEmitterFactory {\n    env: Env\n\n    constructor(env: Env) {\n        if(env.particle_factory !== undefined) { throw new Error(\"Only one factory per env\")}\n        this.env = env\n    }\n    create(x, y, opts) {\n        return new Emitter(x, y, {env: this.env, ...opts})\n    }\n}\n\nexport class Emitter{\n    static numParticles = 0;\n    env: Env\n    particlesAdded: number\n    pos: {x, y}\n    options: any \n    running: boolean\n    owner: Player\n\n    constructor(x, y, {owner, env, ...options}) {\n        this.env = env\n        this.particlesAdded = 0;\n        let defaults = Emitter.defaults;\n        //Reset options to defaults\n        // let options = (...defaults, ...options)\n        if (options === undefined) {\n            options = defaults;\n        }\n        if (options.collisions === undefined) {\n            options.collisions = defaults.collisions;\n        }\n        if (options.isStatic === undefined) {\n            options.isStatic = defaults.isStatic;\n        }\n        if (options.size === undefined) {\n            options.size = defaults.size;\n        } else if (typeof options.size === \"number\") {\n            options.size = {\n                min: options.size,\n                max: options.size\n            };\n        }\n        if (options.amount === undefined) {\n            options.amount = defaults.amount;\n        }\n        if (options.interval === undefined) {\n            options.interval = defaults.interval;\n        }\n        if (options.velocity === undefined) {\n            options.velocity = defaults.velocity;\n        }\n        if (options.velocity.direction === undefined) {\n            options.velocity.direction = defaults.velocity.direction;\n        } else if (options.velocity.direction.x === undefined) {\n            options.velocity.direction.x = defaults.velocity.direction.x;\n        } else if (options.velocity.direction.y === undefined) {\n            options.velocity.direction.y = defaults.velocity.direction.y;\n        }\n        if (options.colors === undefined) {\n            options.colors = defaults.colors;\n        } else if (typeof options.colors === \"string\") {\n            options.colors = [options.colors];\n        }\n        if (options.delay === undefined) {\n            options.delay = defaults.delay;\n        }\n        if (options.frictionAir === undefined) {\n            options.frictionAir = defaults.frictionAir;\n        }\n        if (options.parent === undefined) {\n            options.parent = defaults.parent;\n        }\n        if (options.collisionFilter === undefined) {\n            options.collisionFilter = defaults.collisionFilter;\n        }\n        if (options.amountPerTick === undefined || options.amountPerTick < 1) {\n            options.amountPerTick = defaults.amountPerTick;\n        }\n        if (options.decaySpeed === undefined) {\n            options.decaySpeed = defaults.decaySpeed;\n        }\n        if (options.decaySpeed < 0) {\n            options.decaySpeed = 0;\n        }\n        if (options.decaySpeed > 1) {\n            options.decaySpeed = 1;\n        }\n\n        options.collisions = options.collisions ? false : true;\n\n        //Reset x/y to defaults\n        if (x === undefined) {\n            x = defaults.x;\n        }\n        if (y === undefined) {\n            y = defaults.y;\n        }\n\n        //Change velocity.direction\n        let dir = options.velocity.direction;\n        if (typeof dir.y === \"string\") {\n            dir.y = dir.y.toLowerCase();\n            if (dir.y === \"up\") {\n                options.velocity.direction.y = -1;\n            } else if (dir.y === \"down\") {\n                options.velocity.direction.y = 1;\n            } else if (dir.y === \"none\") {\n                options.velocity.direction.y = 0;\n            }\n        }\n        if (typeof dir.x === \"string\") {\n            dir.x = dir.x.toLowerCase();\n            if (dir.x === \"left\") {\n                options.velocity.direction.x = -1;\n            } else if (dir.x === \"right\") {\n                options.velocity.direction.x = 1;\n            } else if (dir.x === \"none\") {\n                options.velocity.direction.x = 0;\n            }\n        }\n\n        this.pos = { x: x, y: y }\n        this.options = options\n        this.running = false\n        this.owner = owner\n    }\n    stop() {\n        let e = this;\n        let amount = this.options.amount;\n        this.options.amount = 0;\n        this.running = false;\n        requestAnimationFrame(function() {\n            requestAnimationFrame(function() {\n                e.options.amount = amount;\n            });\n        });\n    }\n    start() {\n        this.running = true\n        this.particlesAdded = 0;\n        this.addParticle();\n    }\n    addParticle(duplicated=false) { // debug / rewrite this\n        let emitter = this\n        let pos = this.pos;\n        let posX = pos.x;\n        let posY = pos.y;\n        let options = this.options;\n        let delay = options.delay / this.env.engine.timing.timeScale;\n        let pSize = options.size;\n        let colors = options.colors;\n        let vel = options.velocity;\n        let number = options.amount;\n        let interval = options.interval;\n        let interactive = options.collisions;\n        let frictionAir = options.frictionAir;\n        let direction = options.velocity.direction;\n        let collisionFilter = options.collisionFilter;\n        let amountPerTick = options.amountPerTick;\n\n        Emitter.numParticles++;\n        this.particlesAdded++;\n\n        if (this.options.parent !== undefined) {\n            let parent = this.options.parent;\n            pos = parent.position;\n            this.pos = pos;\n\n            if (parent.label === \"Circle Body\") {\n                let angle = Math.random() * Math.PI * 2;\n                let dist = Math.random() * parent.circleRadius;\n\n                posX = dist * Math.cos(angle) + posX;\n                posY = dist * Math.sin(angle) + posY;\n            } else if (parent.label === \"Rectangle Body\") {\n                posX =\n                    Math.random() * (parent.bounds.max.x - parent.bounds.min.x) +\n                    parent.bounds.min.x;\n                posY =\n                    Math.random() * (parent.bounds.max.y - parent.bounds.min.y) +\n                    parent.bounds.min.y;\n            }\n        }\n\n        let name = \"particle\" + Emitter.numParticles;\n        let size = random(pSize.min, pSize.max);\n        let color = colors[Math.round(random(colors.length))];\n        color = color !== undefined ? color : colors[0];\n\n        if (color === \"random\") {\n            let r = random(0, 255);\n            let g = random(0, 255);\n            let b = random(0, 255);\n            color = \"rgb(\" + r + \", \" + g + \", \" + b + \")\";\n        }\n\n        let particle_opts = (({\n            friction,\n            frictionStatic,\n            inertia\n        }) => ({\n            friction,\n            frictionStatic,\n            inertia\n        }))(this.options);\n        //let pattern = get_pattern()\n        let particle = Bodies.polygon(posX, posY, 6, size, {\n            isSensor: interactive,\n            isStatic: this.options.isStatic,\n            density: 1,\n            restitution: this.options.restituition,\n            frictionAir: frictionAir,\n            render: {\n                // fillStyle: pattern\n                fillStyle: color\n                // ,sprite: {\n                //     texture: ball,\n                //     xScale: 0.01,\n                //     yScale: 0.01\n                // }\n            },\n            ...particle_opts\n        });\n        particle.decaySpeed = options.decaySpeed\n        particle.isParticle = true\n        particle.owner = this.owner\n        this.env.particles[name] = particle\n\n        Composite.add(this.env.world, particle);\n\n        if (collisionFilter !== undefined) {\n            particle.collisionFilter = collisionFilter;\n        }\n\n        let velX = random(0, vel.x);\n        let velY = random(0, vel.y);\n\n        if (vel.y === undefined) {\n            velY = random(0, 2);\n        }\n        if (vel.x === undefined) {\n            velX = random(0, 2);\n        }\n\n        if (direction.x === undefined || direction.x === 0) {\n            velX = Boolean(Math.round(random())) ? velX : velX * -1;\n        } else {\n            velX *= direction.x;\n        }\n\n        if (direction.y === undefined || direction.y === 0) {\n            velY = Boolean(Math.round(random())) ? velY : velY * -1;\n        } else {\n            velY *= direction.y;\n        }\n        Body.setVelocity(particle, {\n            x: velX,\n            y: velY\n        });\n\n        let scale = 1;\n\n        function decreaseScale() {\n            scale -= options.decaySpeed * emitter.env.engine.timing.timeScale;\n            particle.circleRadius = size * scale;\n            if (particle.circleRadius > options.decaySpeed) {\n                requestAnimationFrame(decreaseScale);\n            } else {\n                Composite.remove(emitter.env.world, particle);\n            }\n        }\n        setTimeout(decreaseScale, delay);\n\n        if (this.particlesAdded < number && !duplicated) {\n            if (interval > 0) {\n                let framesPast = 0;\n                function waitForInterval() {\n                    if (emitter.options.amount > 0) {\n                        framesPast += emitter.env.engine.timing.timeScale;\n                        if (emitter.env.runner !== undefined && emitter.env.runner.fps !== undefined) {\n                            if (framesPast >= interval / (1000 / emitter.env.runner.fps)) {\n                                if (amountPerTick > 1) {\n                                    for (let i = amountPerTick; i--;) {\n                                        if (i !== 0) {\n                                            emitter.addParticle(true);\n                                        } else {\n                                            emitter.addParticle();\n                                        }\n                                    }\n                                } else {\n                                    //here\n                                    emitter.addParticle();\n                                }\n                            } else {\n                                requestAnimationFrame(waitForInterval);\n                            }\n                        } else {\n                            if (\n                                framesPast >=\n                                interval / 16.67 / emitter.env.engine.timing.timeScale\n                            ) {\n                                for (let i = amountPerTick; i--;) {\n                                    if (i !== 0) {\n                                        emitter.addParticle(true);\n                                    } else {\n                                        emitter.addParticle();\n                                    }\n                                }\n                            } else {\n                                requestAnimationFrame(waitForInterval);\n                            }\n                        }\n                    } else {\n                        emitter.running = false;\n                    }\n                }\n                requestAnimationFrame(waitForInterval);\n            } else {\n                emitter.addParticle();\n            }\n        }\n    }\n\n    static defaults = {\n        colors: [\"#FE601C\", \"#EBDB14\", \"#EB471F\", \"#ED7A0E\"],\n        collisions: false,\n        isStatic: false,\n        x: window.innerWidth / 2,\n        y: window.innerHeight / 2,\n        size: {\n            min: 0.5,\n            max: 2\n        },\n        amount: 50,\n        interval: 0,\n        amountPerTick: 1,\n        velocity: {\n            x: 5,\n            y: 5,\n            direction: {\n                x: \"none\",\n                y: \"none\"\n            }\n        },\n        delay: 400,\n        decaySpeed: 0.1,\n        frictionAir: 0.02,\n        parent: undefined,\n        collisionFilter: undefined\n    }\n}\n\nfunction random(min:any=undefined, max:any=undefined) {\n        if (min === undefined && max === undefined) {\n            min = 0;\n            max = 1;\n        } else if (max === undefined) {\n            max = min;\n            min = 0;\n        }\n        return Math.random() * (max - min) + min;\n}\n\n","/* eslint no-unused-vars: \"off\" */\nimport Color from \"color\";\nimport { Bodies, Body, Composite, World } from 'matter-js';\nimport { Env } from \"./env\";\nimport { Emitter } from \"./particle-factory\";\n\nconst pallete = '#F51720 #FA26A0 #F8D210 #2FF3E0'.split(' ').map(x => new Color(x))\n\nexport default class Player {\n    shape: Body\n    health: number\n    max_health: number\n    died_at: Date | null\n    damage_dealt: number\n    idx: number\n    env: Env\n    world: World\n    color: Color\n    original_color: Color\n    emitter! : Emitter\n    name: string\n    damage_per_ball: number\n    balls_per_second: number\n\n\n  static idx = 0;\n  constructor(x, y, env, {max_health, name, damage_per_ball, balls_per_second}) {\n    this.idx = Player.idx++;\n    this.max_health = max_health;\n    this.health = this.max_health;\n    this.env = env;\n    this.world = this.env.world;\n    this.color = pallete[this.idx % pallete.length]\n    this.original_color = pallete[this.idx % pallete.length]\n    this.shape = this._build_shape(x, y);\n    this.damage_per_ball = damage_per_ball\n    this.balls_per_second = balls_per_second\n    this.damage_dealt = 0\n    this.died_at = null\n    this.name = name\n  }\n\n  _build_shape(x, y) {\n    let opts = {\n      isStatic: true,\n      render: {\n        fillStyle: this.color.string(),\n        strokeStyle: \"white\",\n        lineWidth: 3\n      },\n      collisionFilter: this.collision_filter\n    };\n    let shape = Bodies.rectangle(x, y, 30, 30, opts)\n    shape.player = this\n    return shape\n  }\n\n  get collision_filter() {\n    let category = 1 << (this.idx + 1); // +1 because category 1 is the default (walls)\n    let mask = -1 ^ category; // colide with all but yourself\n    return { category: category, mask: mask, group: 0 };\n  }\n\n  build_emitter() {\n    let opts = {\n      amount: Infinity,\n      interval: 1000 / this.balls_per_second,\n      amountPerTick: 1, // batch size\n      size: { min: 5, max: 20 },\n      delay: 1000 * 10,\n      collisions: true,\n      restituition: 1,\n      colors: this.original_color.string(),\n      collisionFilter: this.collision_filter,\n      frictionStatic: 0,\n      frictionAir: 0,\n      friction: 0,\n      decaySpeed: 0.03,\n    };\n    // Composite.add(this.world, Bodies.polygon(300, 300, 10, 50, {restituition: 1, friction:0, frictionAir:0, frictionStatic:0}))\n    // return\n    this.emitter = this.env.particle_factory.create(\n      this.x,\n      this.y,\n      {owner: this, ...opts}\n    );\n    this.emitter.start();\n  }\n\n  get x() {\n    return this.shape.position.x;\n  }\n\n  get y() {\n    return this.shape.position.y;\n  }\n\n  take_damage(damage) {\n    this.health -= damage;\n    if (this.health <= 0) {\n      this.die();\n    }\n    let health_percentage = this.health / this.max_health;\n    this.color = this.color.alpha(health_percentage)\n    this.shape.render.fillStyle = this.color.string();\n    return damage\n  }\n\n  die() {\n    console.log(`Player ${this.idx} DIED`);\n    Composite.remove(this.world, this.shape);\n    this.emitter.stop();\n    this.died_at = new Date()\n  }\n}\n\n","/* eslint no-unused-vars: \"off\" */\nimport Matter, { Bodies, Composite, Engine,\n    Events, Mouse, MouseConstraint, Render, Runner, Vector, \n} from 'matter-js';\nimport { ParticleEmitterFactory } from \"./particle-factory\";\nimport Player from \"./player\";\n\n// @ts-ignore\nMatter.Resolver._restingThresh = 0.1 // solving bug: https://github.com/liabru/matter-js/issues/394\n// @ts-ignore\nMatter.Resolver._restingThreshTangent = 1\n\n\nconsole.clear();\n// matter-tools by liabru https://github.com/liabru/matter-tools\n\n\ndeclare module 'matter-js' {\n  interface Body {\n    player: Player\n    owner: Player\n  }\n}\n\n\n//type FUN = (arg:any) => any\nconst MAX_PLAYERS = 8\n\nexport class Env {\n    game_state_callback: Function | undefined\n    engine!: Engine\n    world: any\n    particle_factory!: ParticleEmitterFactory\n    render!: Render\n    runner!: Runner\n    particles: {}\n    H: number; W: number\n    walls!: Matter.Bodies[];\n\n    constructor(game_state_callback?, opts?: {H?, W?}){\n        this.particles = {}\n\n        // create engine\n        this.engine = Engine.create({velocityIterations: 8});\n        // @ts-ignore\n        this.engine.gravity.scale = 0;\n        this.world = this.engine.world;\n\n        this.particle_factory = new ParticleEmitterFactory(this);\n        this.game_state_callback = game_state_callback\n\n        this.H = opts?.H || 1000;\n        this.W = opts?.W || 1000;\n        console.log(this.H)\n    }\n    destroy(){\n        this.stop()\n        Composite.clear(this.world, false, true);\n        Engine.clear(this.engine);\n        this.game_state_callback = undefined\n    }\n    setup(element_id: string, player_stats : Array<Object>) {\n        var render = Render.create({\n            element: document.getElementById(element_id) as HTMLElement,\n            engine: this.engine,\n            options: {\n                width: this.W,\n                height: this.H,\n                wireframes: false,\n                // @ts-ignore\n                showDebug: false,\n                showAngleIndicator: true,\n            }\n        });\n        this.render = render;\n\n        Render.run(render);\n\n        // create runner\n        this.runner = Runner.create();\n\n        this.add_mouse_control();\n        this.build_players(player_stats);\n\n        this.update_game_state()\n\n        this.register_events();\n\n        Runner.run(this.runner, this.engine);\n\n        // fit the render viewport to the scene\n        Render.lookAt(render, {\n            min: { x: 0, y: 0 },\n            max: { x: this.W, y: this.H }\n        });\n    }\n    add_mouse_control() {\n        var mouse = Mouse.create(this.render.canvas),\n            mouseConstraint = MouseConstraint.create(this.engine, {\n                mouse: mouse,\n                // @ts-ignore\n                constraint: {\n                    stiffness: 0.0002,\n                    render: {\n                        visible: true\n                    }\n                }\n            });\n        Events.on(mouseConstraint, 'mousedown', function (event) {\n            // @ts-ignore\n            var mousePosition = event.mouse.position;\n            console.log('mousedown at ' + mousePosition.x + ' ' + mousePosition.y);\n        });\n\n        Composite.add(this.world, mouseConstraint as any);\n        // @ts-ignore\n        this.render.mouse = mouse;\n    }\n    stop() {\n        Matter.Render.stop(this.render);\n        Matter.Runner.stop(this.runner);\n    }\n    players!: Array<Player>\n\n    get_player_coords(idx, n: number) {\n        if (n < 2) throw new Error('only >= 2 players supported')\n        if (idx >= n) throw new Error(`wrong index ${idx} >= ${n}`)\n        if (n === 2)\n            idx = {0: 3, 1: 1}[idx] // if 2 players on a square, position players so that oponents face each other\n        let margin = 120\n        let wall: Vector[] = (this.walls[idx] as any).vertices\n        let [v0, v1] = find_largest_line(wall)\n        let perp = Vector.normalise(Vector.perp(Vector.sub(v1, v0)))\n        let middle = Vector.mult(Vector.add(v0, v1), 0.5)\n        let coords = Vector.add(Vector.mult(perp, margin), middle)\n        return coords\n    }\n    build_players(player_stats) {\n        if(player_stats.length < 2 || player_stats.length > MAX_PLAYERS)\n            throw new Error(`Unsuported number of players ${player_stats.length}`);\n        this.build_play_field(player_stats.length)\n        this.players = []\n        player_stats.forEach((p_stats, idx) => {\n            let {x, y} = this.get_player_coords(idx, player_stats.length)\n            let p = new Player(x, y, this, p_stats);\n            this.players.push(p)\n            Composite.add(this.world, p.shape);\n        })\n        this.players.map((p) => p.build_emitter());\n    }\n    build_play_field(n_players) {\n        let opts = { isStatic: true } //, friction:0, restituition:1, frictionStatic:0, inertia: 10000};\n        let walls : Bodies[] = []\n        if (n_players === 2)\n            n_players = 4 // build a square anyway\n        // build a regular polygon\n        const middle = {x: this.W/2, y: this.H/2}, border = 30\n        const radius = (Math.min(this.W/2, this.H/2)-border) / Math.cos(Math.PI/n_players) // multiplying by constant to convert radius to inradius\n        const smaller = Bodies.polygon(middle.x, middle.y, n_players, radius).vertices\n        const bigger  = Bodies.polygon(middle.x, middle.y, n_players, radius + border).vertices\n        for (var i=0; i< smaller.length; i++) {\n            const ip1 = (i+1)%smaller.length\n            const sides = [smaller[i], smaller[ip1], bigger[ip1], bigger[i]]\n            let b = Bodies.fromVertices(middle.x, middle.y, [sides], opts)\n            const offset = {x: sides[0].x - b.vertices[0].x, y: sides[0].y - b.vertices[0].y} // fromVertices translates bodies immediatly after creation, so we undo this\n            Matter.Body.translate(b, offset)\n            walls.push(b)\n        }\n        this.walls = walls\n        Composite.add(this.world, walls as any);\n    }\n    update_game_state() {\n        if (!this.game_state_callback) return\n        let game_state = this.players.map(p => {return {\n            health: p.health, died_at: p.died_at || null, damage_dealt: p.damage_dealt\n        }})\n        setTimeout(() => this.game_state_callback!(game_state), 0)\n    }\n    register_events() {\n        const env = this\n        Events.on(this.engine, \"collisionStart\", function (e) { // cant seem to register event on players object themselves TODO: check this later\n          var pairs = e.pairs;\n          pairs = pairs.filter((el, _) => {\n            return el.bodyA.player || el.bodyB.player;\n          });\n\n          // change object colours to show those starting a collision\n          for (var i = 0; i < pairs.length; i++) {\n            let pair = pairs[i];\n            let player_shape = pair.bodyA.player ? pair.bodyA : pair.bodyB;\n            let other_shape = !pair.bodyA.player ? pair.bodyA : pair.bodyB;\n            let player = player_shape.player;\n            if (other_shape.isParticle){\n                Composite.remove(env.world, other_shape)\n                explode(other_shape.position, env.particle_factory)\n            }\n            let damage = other_shape.owner.damage_per_ball\n            player.take_damage(damage);\n            if (other_shape.owner === undefined){\n                debugger\n            }\n            other_shape.owner.damage_dealt += damage\n            env.update_game_state()\n          }\n        });\n    }\n\n    title = \"Env\";\n    for = \">=0.14.2\";\n}\n\nfunction explode(position, particle_factory) {\n    let emitter = particle_factory.create(\n            position.x,\n            position.y,\n            {collisions: false, amount: 40, amountPerTick:10, interval: 1, collisionFilter:{group: -1}}\n    );\n    emitter.start();\n}\n\nfunction find_largest_line(v: Vector[]){\n    let max_idx = 0, max_mag = 0\n    for(var i=0; i<v.length;i++){\n        let mag = Vector.magnitudeSquared(Vector.sub(v[i], v[(i+1)% v.length]))\n        if(max_mag < mag){\n            max_mag = mag\n            max_idx = i\n        }\n    }\n    return [v[max_idx], v[(max_idx+1)%v.length]]\n}","import React, { useEffect, useMemo, useRef } from 'react';\nimport { useState } from 'react';\nimport { Table } from './Table';\nimport Button from 'react-bootstrap/Button';\nimport { transform_stats_in_attributes } from \"./stats\";\nimport { Attributes, stats_to_attributes, } from './App';\nimport * as Env from './env'\n\ndeclare global { interface Window {\n    env: Env.Env\n} }\n\nexport function Game({ stats, }) {\n    const [attributes, multipliers]: [Attributes, { [key: string]: number; }] = useMemo(\n        () => transform_stats_in_attributes(stats, stats_to_attributes), [stats]);\n    let [game_state, set_game_state] = useState(null);\n    let [start_time, set_start_time] = useState(new Date());\n    let canvas = useRef<any>();\n\n\n    function restart_sim() {\n        rebuild_canvas(canvas, attributes, set_game_state);\n        set_start_time(new Date());\n    }\n\n    useEffect(() => {\n        rebuild_canvas(canvas, attributes, set_game_state);\n        return () => window.env.destroy();\n    }, [attributes]);\n\n    return (<div className=\"container\">\n        <div style={{ overflowY: 'scroll' }}>\n            <Table stats={stats} attributes={attributes}\n                stats_to_attributes={stats_to_attributes}\n                game_state={game_state} start_time={start_time}\n                multipliers={multipliers} />\n        </div>\n        <Button onClick={restart_sim}> Restart Simulation </Button>\n        <div className=\"mt-1\"></div>\n        <div id=\"canvas\" ref={canvas}></div>\n    </div>);\n}\n\nfunction rebuild_canvas(canvas, attributes, set_game_state) {\n    if (canvas.current === undefined) return\n    window.env?.destroy()\n    window.env = new Env.Env(set_game_state, )\n    canvas.current.innerHTML = \"\"\n    window.env.setup(\"canvas\", attributes);\n    console.log('rebuilding canvas')\n}","import './App.css';\nimport React from 'react'\nimport {useState} from 'react'\n\nimport 'bootstrap/dist/css/bootstrap.min.css';\n\n\nimport { BrowserRouter as Router, Route, } from \"react-router-dom\";\n\nimport Debugger from \"./Debugger\"\n\nimport stats_with_metadata from './StatLoader'\nimport StatSelector from './StatSelector'\nimport { Game } from './Game';\n\n\n/*\n* stats: real life stats\n* attributes: game initial attributes \n* game_state: game current state\n*/\ntype _StringKeyObject = {[key: string]: any}\ntype Stat = _StringKeyObject\nexport type Stats = Stat[]\nexport type Attributes = _StringKeyObject[]\n// type GameState = _StringKeyObject\n\nexport const stats_to_attributes = {\n    name: 'time',\n    max_health: 'defesas_total',\n    balls_per_second: 'gols_total',\n    damage_per_ball: 'vitorias_total'\n}\n\nexport const attribute_labels = {\n    name: 'Player Name',\n    max_health: 'Max Health',\n    balls_per_second: 'Balls per Second',\n    damage_per_ball: 'Damage per Ball'\n}\n\nlet all_stats : Stats = stats_with_metadata.data\n\nfunction App() {\n    let [filtered_stats, set_filtered_stats] = useState(null);\n    let [is_simulating, set_is_simulating] = useState(false);\n    return (\n        <Router>\n            <Route path=\"*#debug\">\n                <Debugger env={window.env}/>\n            </Route>\n            <Route path=\"/\">\n            <div className=\"App\">\n                <StatSelector {...{is_simulating}} filtered_stats={filtered_stats} all_stats={all_stats}\n                        set_filtered_stats={set_filtered_stats} set_is_simulating={set_is_simulating}/>\n                { is_simulating ? \n                    (filtered_stats ? \n                        <Game stats={filtered_stats}/>\n                    :\n                        'No data to sim'\n                    )\n                  : null\n                }\n            </div>\n            </Route>\n        </Router>\n    )\n}\n\n\n\nexport default App;","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}