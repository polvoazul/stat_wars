{"version":3,"sources":["particle-factory.ts","player.ts","env.ts","Table.tsx","stats.js","App.tsx","reportWebVitals.js","index.js"],"names":["ParticleEmitterFactory","env","undefined","particle_factory","Error","this","x","y","opts","Emitter","owner","options","particlesAdded","pos","running","defaults","collisions","isStatic","size","min","max","amount","interval","velocity","direction","colors","delay","frictionAir","parent","collisionFilter","amountPerTick","decaySpeed","dir","toLowerCase","e","requestAnimationFrame","addParticle","duplicated","emitter","posX","posY","engine","timing","timeScale","pSize","vel","number","interactive","numParticles","position","label","angle","Math","random","PI","dist","circleRadius","cos","sin","bounds","name","color","round","length","r","g","b","particle_opts","friction","frictionStatic","inertia","particle","Bodies","polygon","isSensor","density","restitution","restituition","render","fillStyle","isParticle","particles","World","add","world","velX","velY","Boolean","Body","setVelocity","scale","decreaseScale","Composite","remove","setTimeout","framesPast","waitForInterval","runner","fps","i","window","innerWidth","innerHeight","pallete","split","map","Color","Player","max_health","shape","health","died_at","damage_dealt","idx","original_color","_build_shape","string","strokeStyle","lineWidth","collision_filter","rectangle","player","category","mask","group","Infinity","create","start","damage","die","health_percentage","alpha","console","log","stop","Date","Matter","Resolver","_restingThresh","_restingThreshTangent","clear","H","W","Env","game_data_callback","players","title","for","Engine","velocityIterations","gravity","element_id","player_stats","Render","element","document","getElementById","width","height","wireframes","showDebug","showAngleIndicator","run","Runner","build_play_field","add_mouse_control","build_players","register_events","lookAt","update_game_data","mouse","Mouse","canvas","mouseConstraint","MouseConstraint","constraint","stiffness","visible","n","player_coords","get_player_coords","forEach","p_stats","p","push","build_emitter","game_data","Events","on","pairs","filter","el","_","bodyA","bodyB","pair","player_shape","other_shape","explode","take_damage","game_data_columns","Header","accessor","Table","props","stats","columns","useMemo","columns_copy","splice","rank","arr","sorted","Set","sort","a","Map","get","_rank_duplicate","game","died_at_string","start_time","toFixed","useTable","data","getTableProps","getTableBodyProps","headerGroups","rows","prepareRow","striped","bordered","hover","headerGroup","getHeaderGroupProps","headers","column","getHeaderProps","row","getRowProps","cells","cell","getCellProps","find_multiplier","mean","target","multiplier","log10","dfd","goals","game_init_data","df","out","mul","values","keys","vals","rv","zip_key_vals","transform_stats_in_game_init_data","App","useState","set_game_data_state","set_start_time","useEffect","innerHTML","setup","className","Button","onClick","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode"],"mappings":"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","file":"static/js/main.51cd09de.chunk.js","sourcesContent":["/* eslint no-unused-vars: \"off\" */\nimport { Bodies, Body, Composite, World } from 'matter-js'\nimport { Env } from './env'\nimport Player from './player'\n\ndeclare module 'matter-js' {\n  interface Body {\n    isParticle: boolean\n    decaySpeed: number\n  }\n  interface Runner {\n    fps: any\n  }\n}\n\n\nexport class ParticleEmitterFactory {\n    env: Env\n\n    constructor(env: Env) {\n        if(env.particle_factory !== undefined) { throw new Error(\"Only one factory per env\")}\n        this.env = env\n    }\n    create(x, y, opts) {\n        return new Emitter(x, y, {env: this.env, ...opts})\n    }\n}\n\nexport class Emitter{\n    static numParticles = 0;\n    env: Env\n    particlesAdded: number\n    pos: {x, y}\n    options: any \n    running: boolean\n    owner: Player\n\n    constructor(x, y, {owner, env, ...options}) {\n        this.env = env\n        this.particlesAdded = 0;\n        let defaults = Emitter.defaults;\n        //Reset options to defaults\n        // let options = (...defaults, ...options)\n        if (options === undefined) {\n            options = defaults;\n        }\n        if (options.collisions === undefined) {\n            options.collisions = defaults.collisions;\n        }\n        if (options.isStatic === undefined) {\n            options.isStatic = defaults.isStatic;\n        }\n        if (options.size === undefined) {\n            options.size = defaults.size;\n        } else if (typeof options.size === \"number\") {\n            options.size = {\n                min: options.size,\n                max: options.size\n            };\n        }\n        if (options.amount === undefined) {\n            options.amount = defaults.amount;\n        }\n        if (options.interval === undefined) {\n            options.interval = defaults.interval;\n        }\n        if (options.velocity === undefined) {\n            options.velocity = defaults.velocity;\n        }\n        if (options.velocity.direction === undefined) {\n            options.velocity.direction = defaults.velocity.direction;\n        } else if (options.velocity.direction.x === undefined) {\n            options.velocity.direction.x = defaults.velocity.direction.x;\n        } else if (options.velocity.direction.y === undefined) {\n            options.velocity.direction.y = defaults.velocity.direction.y;\n        }\n        if (options.colors === undefined) {\n            options.colors = defaults.colors;\n        } else if (typeof options.colors === \"string\") {\n            options.colors = [options.colors];\n        }\n        if (options.delay === undefined) {\n            options.delay = defaults.delay;\n        }\n        if (options.frictionAir === undefined) {\n            options.frictionAir = defaults.frictionAir;\n        }\n        if (options.parent === undefined) {\n            options.parent = defaults.parent;\n        }\n        if (options.collisionFilter === undefined) {\n            options.collisionFilter = defaults.collisionFilter;\n        }\n        if (options.amountPerTick === undefined || options.amountPerTick < 1) {\n            options.amountPerTick = defaults.amountPerTick;\n        }\n        if (options.decaySpeed === undefined) {\n            options.decaySpeed = defaults.decaySpeed;\n        }\n        if (options.decaySpeed < 0) {\n            options.decaySpeed = 0;\n        }\n        if (options.decaySpeed > 1) {\n            options.decaySpeed = 1;\n        }\n\n        options.collisions = options.collisions ? false : true;\n\n        //Reset x/y to defaults\n        if (x === undefined) {\n            x = defaults.x;\n        }\n        if (y === undefined) {\n            y = defaults.y;\n        }\n\n        //Change velocity.direction\n        let dir = options.velocity.direction;\n        if (typeof dir.y === \"string\") {\n            dir.y = dir.y.toLowerCase();\n            if (dir.y === \"up\") {\n                options.velocity.direction.y = -1;\n            } else if (dir.y === \"down\") {\n                options.velocity.direction.y = 1;\n            } else if (dir.y === \"none\") {\n                options.velocity.direction.y = 0;\n            }\n        }\n        if (typeof dir.x === \"string\") {\n            dir.x = dir.x.toLowerCase();\n            if (dir.x === \"left\") {\n                options.velocity.direction.x = -1;\n            } else if (dir.x === \"right\") {\n                options.velocity.direction.x = 1;\n            } else if (dir.x === \"none\") {\n                options.velocity.direction.x = 0;\n            }\n        }\n\n        this.pos = { x: x, y: y }\n        this.options = options\n        this.running = false\n        this.owner = owner\n    }\n    stop() {\n        let e = this;\n        let amount = this.options.amount;\n        this.options.amount = 0;\n        this.running = false;\n        requestAnimationFrame(function() {\n            requestAnimationFrame(function() {\n                e.options.amount = amount;\n            });\n        });\n    }\n    start() {\n        this.running = true\n        this.particlesAdded = 0;\n        this.addParticle();\n    }\n    addParticle(duplicated=false) {\n        let emitter = this\n        let pos = this.pos;\n        let posX = pos.x;\n        let posY = pos.y;\n        let options = this.options;\n        let delay = options.delay / this.env.engine.timing.timeScale;\n        let pSize = options.size;\n        let colors = options.colors;\n        let vel = options.velocity;\n        let number = options.amount;\n        let interval = options.interval;\n        let interactive = options.collisions;\n        let frictionAir = options.frictionAir;\n        let direction = options.velocity.direction;\n        let collisionFilter = options.collisionFilter;\n        let amountPerTick = options.amountPerTick;\n\n        Emitter.numParticles++;\n        this.particlesAdded++;\n\n        if (this.options.parent !== undefined) {\n            let parent = this.options.parent;\n            pos = parent.position;\n            this.pos = pos;\n\n            if (parent.label === \"Circle Body\") {\n                let angle = Math.random() * Math.PI * 2;\n                let dist = Math.random() * parent.circleRadius;\n\n                posX = dist * Math.cos(angle) + posX;\n                posY = dist * Math.sin(angle) + posY;\n            } else if (parent.label === \"Rectangle Body\") {\n                posX =\n                    Math.random() * (parent.bounds.max.x - parent.bounds.min.x) +\n                    parent.bounds.min.x;\n                posY =\n                    Math.random() * (parent.bounds.max.y - parent.bounds.min.y) +\n                    parent.bounds.min.y;\n            }\n        }\n\n        let name = \"particle\" + Emitter.numParticles;\n        let size = random(pSize.min, pSize.max);\n        let color = colors[Math.round(random(colors.length))];\n        color = color !== undefined ? color : colors[0];\n\n        if (color === \"random\") {\n            let r = random(0, 255);\n            let g = random(0, 255);\n            let b = random(0, 255);\n            color = \"rgb(\" + r + \", \" + g + \", \" + b + \")\";\n        }\n\n        let particle_opts = (({\n            friction,\n            frictionStatic,\n            inertia\n        }) => ({\n            friction,\n            frictionStatic,\n            inertia\n        }))(this.options);\n        let particle = Bodies.polygon(posX, posY, 6, size, {\n            isSensor: interactive,\n            isStatic: this.options.isStatic,\n            density: 1,\n            restitution: this.options.restituition,\n            frictionAir: frictionAir,\n            render: {\n                fillStyle: color\n            },\n            ...particle_opts\n        });\n        particle.decaySpeed = options.decaySpeed\n        particle.isParticle = true\n        particle.owner = this.owner\n        this.env.particles[name] = particle\n\n        World.add(this.env.world, particle);\n\n        if (collisionFilter !== undefined) {\n            particle.collisionFilter = collisionFilter;\n        }\n\n        let velX = random(0, vel.x);\n        let velY = random(0, vel.y);\n\n        if (vel.y === undefined) {\n            velY = random(0, 2);\n        }\n        if (vel.x === undefined) {\n            velX = random(0, 2);\n        }\n\n        if (direction.x === undefined || direction.x === 0) {\n            velX = Boolean(Math.round(random())) ? velX : velX * -1;\n        } else {\n            velX *= direction.x;\n        }\n\n        if (direction.y === undefined || direction.y === 0) {\n            velY = Boolean(Math.round(random())) ? velY : velY * -1;\n        } else {\n            velY *= direction.y;\n        }\n        Body.setVelocity(particle, {\n            x: velX,\n            y: velY\n        });\n\n        let scale = 1;\n\n        function decreaseScale() {\n            scale -= options.decaySpeed * emitter.env.engine.timing.timeScale;\n            particle.circleRadius = size * scale;\n            if (particle.circleRadius > options.decaySpeed) {\n                requestAnimationFrame(decreaseScale);\n            } else {\n                Composite.remove(emitter.env.world, particle);\n            }\n        }\n        setTimeout(decreaseScale, delay);\n\n        if (this.particlesAdded < number && !duplicated) {\n            if (interval > 0) {\n                let framesPast = 0;\n                function waitForInterval() {\n                    if (emitter.options.amount > 0) {\n                        framesPast += emitter.env.engine.timing.timeScale;\n                        if (emitter.env.runner !== undefined && emitter.env.runner.fps !== undefined) {\n                            if (framesPast >= interval / (1000 / emitter.env.runner.fps)) {\n                                if (amountPerTick > 1) {\n                                    for (let i = amountPerTick; i--;) {\n                                        if (i !== 0) {\n                                            emitter.addParticle(true);\n                                        } else {\n                                            emitter.addParticle();\n                                        }\n                                    }\n                                } else {\n                                    emitter.addParticle();\n                                }\n                            } else {\n                                requestAnimationFrame(waitForInterval);\n                            }\n                        } else {\n                            if (\n                                framesPast >=\n                                interval / 16.67 / emitter.env.engine.timing.timeScale\n                            ) {\n                                for (let i = amountPerTick; i--;) {\n                                    if (i !== 0) {\n                                        emitter.addParticle(true);\n                                    } else {\n                                        emitter.addParticle();\n                                    }\n                                }\n                            } else {\n                                requestAnimationFrame(waitForInterval);\n                            }\n                        }\n                    } else {\n                        emitter.running = false;\n                    }\n                }\n                requestAnimationFrame(waitForInterval);\n            } else {\n                this.addParticle();\n            }\n        }\n    }\n\n    static defaults = {\n        colors: [\"#FE601C\", \"#EBDB14\", \"#EB471F\", \"#ED7A0E\"],\n        collisions: false,\n        isStatic: false,\n        x: window.innerWidth / 2,\n        y: window.innerHeight / 2,\n        size: {\n            min: 0.5,\n            max: 2\n        },\n        amount: 50,\n        interval: 0,\n        amountPerTick: 1,\n        velocity: {\n            x: 5,\n            y: 5,\n            direction: {\n                x: \"none\",\n                y: \"none\"\n            }\n        },\n        delay: 400,\n        decaySpeed: 0.1,\n        frictionAir: 0.02,\n        parent: undefined,\n        collisionFilter: undefined\n    }\n}\n\nfunction random(min:any=undefined, max:any=undefined) {\n        if (min === undefined && max === undefined) {\n            min = 0;\n            max = 1;\n        } else if (max === undefined) {\n            max = min;\n            min = 0;\n        }\n        return Math.random() * (max - min) + min;\n}\n\n","/* eslint no-unused-vars: \"off\" */\nimport Color from \"color\";\nimport { Bodies, Body, Composite, World } from 'matter-js';\nimport { Env } from \"./env\";\nimport { Emitter } from \"./particle-factory\";\n\nconst pallete = '#F51720 #FA26A0 #F8D210 #2FF3E0'.split(' ').map(x => new Color(x))\n\nexport default class Player {\n    shape: Body\n    health: number\n    max_health: number\n    died_at: Date | null\n    damage_dealt: number\n    idx: number\n    env: Env\n    world: World\n    color: Color\n    original_color: Color\n    emitter! : Emitter\n    name: string\n\n\n  static idx = 0;\n  constructor(x, y, env, {max_health, name}) {\n    this.idx = Player.idx++;\n    this.max_health = max_health;\n    this.health = this.max_health;\n    this.env = env;\n    this.world = this.env.world;\n    this.color = pallete[this.idx % pallete.length]\n    this.original_color = pallete[this.idx % pallete.length]\n    this.shape = this._build_shape(x, y);\n    this.damage_dealt = 0\n    this.died_at = null\n    this.name = name\n  }\n\n  _build_shape(x, y) {\n    let opts = {\n      isStatic: true,\n      render: {\n        fillStyle: this.color.string(),\n        strokeStyle: \"white\",\n        lineWidth: 3\n      },\n      collisionFilter: this.collision_filter\n    };\n    let shape = Bodies.rectangle(x, y, 30, 30, opts)\n    shape.player = this\n    return shape\n  }\n\n  get collision_filter() {\n    let category = 1 << (this.idx + 1); // +1 because category 1 is the default (walls)\n    let mask = -1 ^ category; // colide with all but yourself\n    return { category: category, mask: mask, group: 0 };\n  }\n\n  build_emitter() {\n    let opts = {\n      amount: Infinity,\n      interval: 1001, // in millis\n      amountPerTick: 1, // batch size\n      size: { min: 5, max: 20 },\n      delay: 1000 * 10,\n      collisions: true,\n      restituition: 1,\n      colors: this.original_color.string(),\n      collisionFilter: this.collision_filter,\n      frictionStatic: 0,\n      frictionAir: 0,\n      friction: 0,\n      decaySpeed: 0.03,\n    };\n    // Composite.add(this.world, Bodies.polygon(300, 300, 10, 50, {restituition: 1, friction:0, frictionAir:0, frictionStatic:0}))\n    // return\n    this.emitter = this.env.particle_factory.create(\n      this.x,\n      this.y,\n      {owner: this, ...opts}\n    );\n    this.emitter.start();\n  }\n\n  get x() {\n    return this.shape.position.x;\n  }\n\n  get y() {\n    return this.shape.position.y;\n  }\n\n  take_damage(damage) {\n    this.health -= damage;\n    if (this.health <= 0) {\n      this.die();\n    }\n    let health_percentage = this.health / this.max_health;\n    this.color = this.color.alpha(health_percentage)\n    this.shape.render.fillStyle = this.color.string();\n    return damage\n  }\n\n  die() {\n    console.log(`Player ${this.idx} DIED`);\n    Composite.remove(this.world, this.shape);\n    this.emitter.stop();\n    this.died_at = new Date()\n  }\n}\n\n","/* eslint no-unused-vars: \"off\" */\nimport Matter, { Bodies, Composite, Engine,\n    Events, Mouse, MouseConstraint, Render, Runner\n} from 'matter-js';\nimport { ParticleEmitterFactory } from \"./particle-factory\";\nimport Player from \"./player\";\n\n// @ts-ignore\nMatter.Resolver._restingThresh = 0.1 // solving bug: https://github.com/liabru/matter-js/issues/394\n// @ts-ignore\nMatter.Resolver._restingThreshTangent = 1\n\n\nconsole.clear();\n// matter-tools by liabru https://github.com/liabru/matter-tools\n\ndeclare global {\n  interface Window {\n      H:any;\n      W:any;\n  }\n}\n\ndeclare module 'matter-js' {\n  interface Body {\n    player: Player\n    owner: Player\n  }\n}\n\nwindow.H = 600;\nwindow.W = 800;\n\n//type FUN = (arg:any) => any\n\nexport class Env {\n    game_data_callback: Function //| undefined\n    engine!: Engine\n    world: any\n    particle_factory!: ParticleEmitterFactory\n    render!: Render\n    runner!: Runner\n    particles: {}\n\n    constructor(game_data_callback?){\n        this.game_data_callback = game_data_callback\n        this.particles = {}\n\n        // create engine\n        this.engine = Engine.create({velocityIterations: 8});\n        // @ts-ignore\n        this.engine.gravity.scale = 0;\n        this.world = this.engine.world;\n\n        this.particle_factory = new ParticleEmitterFactory(this);\n    }\n\n    setup(element_id: string, player_stats : Array<Object>) {\n        var render = Render.create({\n            element: document.getElementById(element_id) as HTMLElement,\n            engine: this.engine,\n            options: {\n                width: 800,\n                height: 600,\n                wireframes: false,\n                // @ts-ignore\n                showDebug: false,\n                showAngleIndicator: true,\n            }\n        });\n        this.render = render;\n\n        Render.run(render);\n\n        // create runner\n        this.runner = Runner.create();\n\n        this.build_play_field();\n        this.add_mouse_control();\n\n        this.build_players(player_stats);\n\n        this.register_events();\n\n        Runner.run(this.runner, this.engine);\n\n        // fit the render viewport to the scene\n        Render.lookAt(render, {\n            min: { x: 0, y: 0 },\n            max: { x: 800, y: 600 }\n        });\n        this.update_game_data()\n    }\n\n  add_mouse_control() {\n    var mouse = Mouse.create(this.render.canvas),\n      mouseConstraint = MouseConstraint.create(this.engine, {\n        mouse: mouse,\n        // @ts-ignore\n        constraint: {\n          stiffness: 0.2,\n          render: {\n            visible: true\n          }\n        }\n      });\n\n    Composite.add(this.world, mouseConstraint as any);\n    // @ts-ignore\n    this.render.mouse = mouse;\n  }\n\n  stop() {\n    Matter.Render.stop(this.render);\n    Matter.Runner.stop(this.runner);\n  }\n\n  players!: Array<Player>\n\n\n  get_player_coords(n: 2) {\n    if(n!==2) throw new Error('only 2 players supported')\n    let margin = 21, play_area = 100;\n    return [\n        [0 + play_area + margin, window.H/2],\n        [window.W - (play_area + margin), window.H/2],\n    ]\n  }\n  build_players(player_stats) {\n    this.players = []\n    const player_coords = this.get_player_coords(player_stats.length)\n    player_stats.forEach( (p_stats, idx) => {\n        let [x, y] = player_coords[idx]\n        let p = new Player(x, y, this, p_stats);\n        this.players.push(p)\n        Composite.add(this.world, p.shape);\n    })\n    this.players.map((p) => p.build_emitter());\n  }\n\n  build_play_field() {\n    // add bodies\n    let opts = { isStatic: true} //, friction:0, restituition:1, frictionStatic:0, inertia: 10000};\n    // @ts-ignore\n    Composite.add(this.world, [ // walls\n      Bodies.rectangle(400, 0, 800, 100, opts),\n      Bodies.rectangle(400, 600, 800, 100, opts),\n      Bodies.rectangle(800, 300, 100, 600, opts),\n      Bodies.rectangle(0, 300, 100, 600, opts)\n    ]);\n  }\n\n    update_game_data() {\n        if (!this.game_data_callback) return\n        let game_data = this.players.map(p => {return {\n            health: p.health, died_at: p.died_at || null, damage_dealt: p.damage_dealt\n        }})\n        setTimeout(() => this.game_data_callback(game_data), 0)\n    }\n    register_events() {\n        const env = this\n        Events.on(this.engine, \"collisionStart\", function (e) { // cant seem to register event on players object themselves TODO: check this later\n          var pairs = e.pairs;\n          pairs = pairs.filter((el, _) => {\n            return el.bodyA.player || el.bodyB.player;\n          });\n\n          // change object colours to show those starting a collision\n          for (var i = 0; i < pairs.length; i++) {\n            let pair = pairs[i];\n            let player_shape = pair.bodyA.player ? pair.bodyA : pair.bodyB;\n            let other_shape = !pair.bodyA.player ? pair.bodyA : pair.bodyB;\n            let player = player_shape.player;\n            if (other_shape.isParticle){\n                Composite.remove(env.world, other_shape)\n                explode(other_shape.position, env.particle_factory)\n            }\n            let damage_dealt = player.take_damage(51);\n            if (other_shape.owner === undefined){\n                //debugger\n            }\n            other_shape.owner.damage_dealt += damage_dealt\n            env.update_game_data()\n          }\n        });\n    }\n\n\n    title = \"Env\";\n    for = \">=0.14.2\";\n}\n\nfunction explode(position, particle_factory) {\n    let emitter = particle_factory.create(\n            position.x,\n            position.y,\n            {collisions: false, amount: 40, amountPerTick:10, interval: 1, collisionFilter:{group: -1}}\n    );\n    emitter.start();\n}\n\n\n//window.restart()\n","import BTable from 'react-bootstrap/Table'\nimport {useTable} from 'react-table'\nimport {useMemo} from 'react'\n\nconst game_data_columns = [\n    { Header: 'Health', accessor: 'game.health', },\n    { Header: 'Died at', accessor: 'game.died_at_string', },\n    { Header: 'Rank', accessor: 'game.rank', },\n    { Header: 'Damage Dealt', accessor: 'game.damage_dealt', },\n]\n\nexport function Table(props) {\n    let stats = [...props.stats]\n\n    let columns = useMemo( () => {\n        const columns_copy = [...props.columns] // this is needed to prevent a bug where columns vanish, needs further investigation as to why\n        if (props.columns === undefined) return []\n        return [columns_copy[0], ...game_data_columns, ...columns_copy.splice(1) ]\n    }, [props.columns])\n\n    let rank = _rank_duplicate(stats.map(x => x.game ? -x.game.died_at : 0))\n\n    for (var i=0; i < props.stats.length; i++) {\n        if(props.game_data[i] === undefined) continue\n        stats[i].game = {...props.game_data[i]}\n        if(stats[i].game.died_at !== null)\n            stats[i].game.died_at_string = ((stats[i].game.died_at - props.start_time)/1000).toFixed(1) + 's'\n        stats[i].game.rank = rank[i]\n    }\n\n\n    //return <div><p>{JSON.stringify(stats)}</p><p>{JSON.stringify(columns)}</p></div>\n    // return (<BTable>\n    //         <thead>{JSON.stringify(stats)}\n    //     <tr {...columns}/></thead></BTable>)\n\n    const {\n        getTableProps,\n        getTableBodyProps,\n        headerGroups,\n        rows,\n        prepareRow\n    } = useTable({columns: columns, data: stats})\n\n   return (\n     <BTable {...getTableProps()} striped bordered hover >\n       <thead>\n         {headerGroups.map(headerGroup => (\n           <tr {...headerGroup.getHeaderGroupProps()}>\n             {headerGroup.headers.map(column => (\n               <th {...column.getHeaderProps()} >\n                 {column.render('Header')}\n               </th>\n             ))}\n           </tr>\n         ))}\n       </thead>\n       <tbody {...getTableBodyProps()}>\n         {rows.map(row => {\n           prepareRow(row)\n           return (\n             <tr {...row.getRowProps()}>\n               {row.cells.map(cell => {\n                 return (\n                   <td\n                     {...cell.getCellProps()}\n                   >\n                     {cell.render('Cell')}\n                   </td>\n                 )\n               })}\n             </tr>\n           )\n         })}\n       </tbody>\n     </BTable>\n   )\n}\n\n\nfunction _rank_duplicate(arr) {\n    const sorted = [...new Set(arr)].sort((a: any, b: any) => b - a);\n    const rank = new Map(sorted.map((x, i) => [x, i + 1]));\n    return arr.map((x) => rank.get(x));\n}","import * as dfd from \"danfojs/src/index\"\nwindow.dfd = dfd\n\nfunction find_multiplier(mean, target){\n    let multiplier = 10**Math.round(Math.log10(target / mean))\n    console.log([mean, target, multiplier] )\n    return multiplier\n}\n\nexport function transform_stats_in_game_init_data(stats) {\n    // @ts-ignore\n    let df = new dfd.DataFrame(stats)\n    window.df = df\n    let out : any = {\n        max_health: df.goals.mul(find_multiplier(df.goals.mean(), 100)).values,\n        name: df.name.values\n    }\n    out = (new dfd.DataFrame(out))\n    let columns = out.columns\n    out = out.values //array of arrays\n    out = out.map(row => zip_key_vals(columns, row))\n    console.log(out)\n    return out\n}\n\nfunction zip_key_vals(keys, vals) {\n  var rv = {};\n  for (var i = 0; i < keys.length; ++i)\n    rv[keys[i]] = vals[i];\n  return rv;\n}","import './App.css';\nimport * as Env from './env'\nimport React, {useEffect} from 'react'\nimport {useState} from 'react'\nimport {Table} from './Table'\n\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport Button from 'react-bootstrap/Button'\n\nimport {transform_stats_in_game_init_data} from \"./stats\"\n\n\ndeclare global { interface Window {\n    env: Env.Env\n} }\n\nwindow.env = new Env.Env()\n\nconst stats = [ { name: 'Vasco', goals: 2 }, { name: 'Botafogo', goals: 5 }, ]\nconst columns = [\n    { Header: 'Nome | Player', accessor: 'name', },\n    { Header: 'Gols | Max Health', accessor: 'goals', },\n]\n\n\nconst game_init_data : Array<Object> = transform_stats_in_game_init_data(stats)\n\nfunction App() {\n    let [game_data, set_game_data_state] = useState([]);\n    let [start_time, set_start_time] = useState(new Date());\n    window.env.game_data_callback = set_game_data_state\n\n\n    function restart() {\n        window.env = new Env.Env(set_game_data_state)\n        window.document.getElementById(\"canvas\")!.innerHTML = \"\"\n        window.env.setup(\"canvas\", game_init_data);\n        set_start_time(new Date())\n    }\n\n    useEffect(() => {\n        window.document.getElementById(\"canvas\")!.innerHTML = \"\"\n        window.env.setup(\"canvas\", game_init_data);\n    }, [])\n\n\n    return (\n        <div className=\"App\">\n            <Button onClick={restart}> RESTART </Button>\n            <Table stats={stats} columns={columns} game_data={game_data} start_time={start_time}/>\n        </div>\n    );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}