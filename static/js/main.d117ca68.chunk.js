(this.webpackJsonpstat_wars=this.webpackJsonpstat_wars||[]).push([[0],{349:function(e,t){},384:function(e,t,i){},385:function(e,t,i){},400:function(e,t){},401:function(e,t){},409:function(e,t){},412:function(e,t){},413:function(e,t){},560:function(e,t){},561:function(e,t){},562:function(e,t,i){"use strict";i.r(t);var n=i(44),o=i.n(n),a=i(351),r=i.n(a),s=(i(384),i(6)),c=(i(385),i(4)),l=i(9),d=i(45),u=i.n(d),h=i(378),v=i(58),m=function(){function e(t){if(Object(c.a)(this,e),this.env=void 0,void 0!==t.particle_factory)throw new Error("Only one factory per env");this.env=t}return Object(l.a)(e,[{key:"create",value:function(e,t,i){return new p(e,t,Object(v.a)({env:this.env},i))}}]),e}(),p=function(){function e(t,i,n){var o=n.owner,a=n.env,r=Object(h.a)(n,["owner","env"]);Object(c.a)(this,e),this.env=void 0,this.particlesAdded=void 0,this.pos=void 0,this.options=void 0,this.running=void 0,this.owner=void 0,this.env=a,this.particlesAdded=0;var s=e.defaults;void 0===r&&(r=s),void 0===r.collisions&&(r.collisions=s.collisions),void 0===r.isStatic&&(r.isStatic=s.isStatic),void 0===r.size?r.size=s.size:"number"===typeof r.size&&(r.size={min:r.size,max:r.size}),void 0===r.amount&&(r.amount=s.amount),void 0===r.interval&&(r.interval=s.interval),void 0===r.velocity&&(r.velocity=s.velocity),void 0===r.velocity.direction?r.velocity.direction=s.velocity.direction:void 0===r.velocity.direction.x?r.velocity.direction.x=s.velocity.direction.x:void 0===r.velocity.direction.y&&(r.velocity.direction.y=s.velocity.direction.y),void 0===r.colors?r.colors=s.colors:"string"===typeof r.colors&&(r.colors=[r.colors]),void 0===r.delay&&(r.delay=s.delay),void 0===r.frictionAir&&(r.frictionAir=s.frictionAir),void 0===r.parent&&(r.parent=s.parent),void 0===r.collisionFilter&&(r.collisionFilter=s.collisionFilter),(void 0===r.amountPerTick||r.amountPerTick<1)&&(r.amountPerTick=s.amountPerTick),void 0===r.decaySpeed&&(r.decaySpeed=s.decaySpeed),r.decaySpeed<0&&(r.decaySpeed=0),r.decaySpeed>1&&(r.decaySpeed=1),r.collisions=!r.collisions,void 0===t&&(t=s.x),void 0===i&&(i=s.y);var l=r.velocity.direction;"string"===typeof l.y&&(l.y=l.y.toLowerCase(),"up"===l.y?r.velocity.direction.y=-1:"down"===l.y?r.velocity.direction.y=1:"none"===l.y&&(r.velocity.direction.y=0)),"string"===typeof l.x&&(l.x=l.x.toLowerCase(),"left"===l.x?r.velocity.direction.x=-1:"right"===l.x?r.velocity.direction.x=1:"none"===l.x&&(r.velocity.direction.x=0)),this.pos={x:t,y:i},this.options=r,this.running=!1,this.owner=o}return Object(l.a)(e,[{key:"stop",value:function(){var e=this,t=this.options.amount;this.options.amount=0,this.running=!1,requestAnimationFrame((function(){requestAnimationFrame((function(){e.options.amount=t}))}))}},{key:"start",value:function(){this.running=!0,this.particlesAdded=0,this.addParticle()}},{key:"addParticle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=this,n=this.pos,o=n.x,a=n.y,r=this.options,s=r.delay/this.env.engine.timing.timeScale,c=r.size,l=r.colors,u=r.velocity,h=r.amount,m=r.interval,p=r.collisions,f=r.frictionAir,g=r.velocity.direction,b=r.collisionFilter,_=r.amountPerTick;if(e.numParticles++,this.particlesAdded++,void 0!==this.options.parent){var w=this.options.parent;if(n=w.position,this.pos=n,"Circle Body"===w.label){var x=Math.random()*Math.PI*2,j=Math.random()*w.circleRadius;o=j*Math.cos(x)+o,a=j*Math.sin(x)+a}else"Rectangle Body"===w.label&&(o=Math.random()*(w.bounds.max.x-w.bounds.min.x)+w.bounds.min.x,a=Math.random()*(w.bounds.max.y-w.bounds.min.y)+w.bounds.min.y)}var O="particle"+e.numParticles,k=y(c.min,c.max),S=l[Math.round(y(l.length))];if("random"===(S=void 0!==S?S:l[0])){var P=y(0,255),A=y(0,255),F=y(0,255);S="rgb("+P+", "+A+", "+F+")"}var B,M={friction:(B=this.options).friction,frictionStatic:B.frictionStatic,inertia:B.inertia},T=d.Bodies.polygon(o,a,6,k,Object(v.a)({isSensor:p,isStatic:this.options.isStatic,density:1,restitution:this.options.restituition,frictionAir:f,render:{fillStyle:S}},M));T.decaySpeed=r.decaySpeed,T.isParticle=!0,T.owner=this.owner,this.env.particles[O]=T,d.Composite.add(this.env.world,T),void 0!==b&&(T.collisionFilter=b);var E=y(0,u.x),C=y(0,u.y);void 0===u.y&&(C=y(0,2)),void 0===u.x&&(E=y(0,2)),void 0===g.x||0===g.x?E=Boolean(Math.round(y()))?E:-1*E:E*=g.x,void 0===g.y||0===g.y?C=Boolean(Math.round(y()))?C:-1*C:C*=g.y,d.Body.setVelocity(T,{x:E,y:C});var R=1;function H(){R-=r.decaySpeed*i.env.engine.timing.timeScale,T.circleRadius=k*R,T.circleRadius>r.decaySpeed?requestAnimationFrame(H):d.Composite.remove(i.env.world,T)}if(setTimeout(H,s),this.particlesAdded<h&&!t)if(m>0){var D=0;function z(){if(i.options.amount>0)if(D+=i.env.engine.timing.timeScale,void 0!==i.env.runner&&void 0!==i.env.runner.fps)if(D>=m/(1e3/i.env.runner.fps))if(_>1)for(var e=_;e--;)0!==e?i.addParticle(!0):i.addParticle();else i.addParticle();else requestAnimationFrame(z);else if(D>=m/16.67/i.env.engine.timing.timeScale)for(var t=_;t--;)0!==t?i.addParticle(!0):i.addParticle();else requestAnimationFrame(z);else i.running=!1}requestAnimationFrame(z)}else i.addParticle()}}]),e}();function y(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return void 0===e&&void 0===t?(e=0,t=1):void 0===t&&(t=e,e=0),Math.random()*(t-e)+e}p.numParticles=0,p.defaults={colors:["#FE601C","#EBDB14","#EB471F","#ED7A0E"],collisions:!1,isStatic:!1,x:window.innerWidth/2,y:window.innerHeight/2,size:{min:.5,max:2},amount:50,interval:0,amountPerTick:1,velocity:{x:5,y:5,direction:{x:"none",y:"none"}},delay:400,decaySpeed:.1,frictionAir:.02,parent:void 0,collisionFilter:void 0};var f=i(352),g=i.n(f),b="#F51720 #FA26A0 #F8D210 #2FF3E0".split(" ").map((function(e){return new g.a(e)})),_=function(){function e(t,i,n,o){var a=o.max_health,r=o.name;Object(c.a)(this,e),this.shape=void 0,this.health=void 0,this.max_health=void 0,this.died_at=void 0,this.damage_dealt=void 0,this.idx=void 0,this.env=void 0,this.world=void 0,this.color=void 0,this.original_color=void 0,this.emitter=void 0,this.name=void 0,this.idx=e.idx++,this.max_health=a,this.health=this.max_health,this.env=n,this.world=this.env.world,this.color=b[this.idx%b.length],this.original_color=b[this.idx%b.length],this.shape=this._build_shape(t,i),this.damage_dealt=0,this.died_at=null,this.name=r}return Object(l.a)(e,[{key:"_build_shape",value:function(e,t){var i={isStatic:!0,render:{fillStyle:this.color.string(),strokeStyle:"white",lineWidth:3},collisionFilter:this.collision_filter},n=d.Bodies.rectangle(e,t,30,30,i);return n.player=this,n}},{key:"collision_filter",get:function(){var e=1<<this.idx+1;return{category:e,mask:-1^e,group:0}}},{key:"build_emitter",value:function(){var e={amount:1/0,interval:1001,amountPerTick:1,size:{min:5,max:20},delay:1e4,collisions:!0,restituition:1,colors:this.original_color.string(),collisionFilter:this.collision_filter,frictionStatic:0,frictionAir:0,friction:0,decaySpeed:.03};this.emitter=this.env.particle_factory.create(this.x,this.y,Object(v.a)({owner:this},e)),this.emitter.start()}},{key:"x",get:function(){return this.shape.position.x}},{key:"y",get:function(){return this.shape.position.y}},{key:"take_damage",value:function(e){this.health-=e,this.health<=0&&this.die();var t=this.health/this.max_health;return this.color=this.color.alpha(t),this.shape.render.fillStyle=this.color.string(),e}},{key:"die",value:function(){console.log("Player ".concat(this.idx," DIED")),d.Composite.remove(this.world,this.shape),this.emitter.stop(),this.died_at=new Date}}]),e}();_.idx=0,u.a.Resolver._restingThresh=.1,u.a.Resolver._restingThreshTangent=1,console.clear(),window.H=600,window.W=800;var w=function(){function e(t){Object(c.a)(this,e),this.game_state_callback=void 0,this.engine=void 0,this.world=void 0,this.particle_factory=void 0,this.render=void 0,this.runner=void 0,this.particles=void 0,this.players=void 0,this.title="Env",this.for=">=0.14.2",this.game_state_callback=t,this.particles={},this.engine=d.Engine.create({velocityIterations:8}),this.engine.gravity.scale=0,this.world=this.engine.world,this.particle_factory=new m(this)}return Object(l.a)(e,[{key:"setup",value:function(e,t){var i=d.Render.create({element:document.getElementById(e),engine:this.engine,options:{width:800,height:600,wireframes:!1,showDebug:!1,showAngleIndicator:!0}});this.render=i,d.Render.run(i),this.runner=d.Runner.create(),this.build_play_field(),this.add_mouse_control(),this.build_players(t),this.register_events(),d.Runner.run(this.runner,this.engine),d.Render.lookAt(i,{min:{x:0,y:0},max:{x:800,y:600}}),this.update_game_state()}},{key:"add_mouse_control",value:function(){var e=d.Mouse.create(this.render.canvas),t=d.MouseConstraint.create(this.engine,{mouse:e,constraint:{stiffness:2e-4,render:{visible:!0}}});d.Composite.add(this.world,t),this.render.mouse=e}},{key:"stop",value:function(){u.a.Render.stop(this.render),u.a.Runner.stop(this.runner)}},{key:"get_player_coords",value:function(e){if(2!==e)throw new Error("only 2 players supported");return[[121,window.H/2],[window.W-121,window.H/2]]}},{key:"build_players",value:function(e){var t=this;this.players=[];var i=this.get_player_coords(e.length);e.forEach((function(e,n){var o=Object(s.a)(i[n],2),a=o[0],r=o[1],c=new _(a,r,t,e);t.players.push(c),d.Composite.add(t.world,c.shape)})),this.players.map((function(e){return e.build_emitter()}))}},{key:"build_play_field",value:function(){var e={isStatic:!0};d.Composite.add(this.world,[d.Bodies.rectangle(400,0,800,100,e),d.Bodies.rectangle(400,600,800,100,e),d.Bodies.rectangle(800,300,100,600,e),d.Bodies.rectangle(0,300,100,600,e)])}},{key:"update_game_state",value:function(){var e=this;if(this.game_state_callback){var t=this.players.map((function(e){return{health:e.health,died_at:e.died_at||null,damage_dealt:e.damage_dealt}}));setTimeout((function(){return e.game_state_callback(t)}),0)}}},{key:"register_events",value:function(){var e=this;d.Events.on(this.engine,"collisionStart",(function(t){var i=t.pairs;i=i.filter((function(e,t){return e.bodyA.player||e.bodyB.player}));for(var n=0;n<i.length;n++){var o=i[n],a=o.bodyA.player?o.bodyA:o.bodyB,r=o.bodyA.player?o.bodyB:o.bodyA,s=a.player;r.isParticle&&(d.Composite.remove(e.world,r),x(r.position,e.particle_factory));var c=s.take_damage(51);r.owner,r.owner.damage_dealt+=c,e.update_game_state()}}))}}]),e}();function x(e,t){t.create(e.x,e.y,{collisions:!1,amount:40,amountPerTick:10,interval:1,collisionFilter:{group:-1}}).start()}var j=i(17),O=i(355),k=i(353),S=i(354),P=i.n(S),A=i(61),F=[{Header:"Health",accessor:"game.health"},{Header:"Died at",accessor:"game.died_at_string"},{Header:"Rank",accessor:"game.rank"},{Header:"Damage Dealt",accessor:"game.damage_dealt"}],B={max_health:"Max Health",name:"Player Name"};function M(e,t,i){return console.log(i),Object.entries(t).map((function(e){var n,o,a,r=Object(s.a)(e,2),c=r[0];r[1];return n=c,o=t[c],a=i[c],{Header:"".concat(B[n]," = ").concat(o," ").concat(a?" x "+a:""),accessor:n}}))}function T(e){for(var t=e.stats,i=e.attributes,o=e.stats_to_attributes,a=e.game_state,r=e.start_time,s=e.multipliers,c=Object(n.useMemo)((function(){var e=M(0,o,s);return[e[0]].concat(F,Object(j.a)(e.splice(1)))}),[i,s,o]),l=function(e){var t=Object(j.a)(new Set(e)).sort((function(e,t){return t-e})),i=new Map(t.map((function(e,t){return[e,t+1]})));return e.map((function(e){return i.get(e)}))}(t.map((function(e){return e.game?-e.game.died_at:0}))),d=P()(i),u=0;u<d.length;u++)void 0!==a[u]&&(d[u].game=Object(v.a)({},a[u]),null!==d[u].game.died_at&&(d[u].game.died_at_string=((d[u].game.died_at-r)/1e3).toFixed(1)+"s"),d[u].game.rank=l[u]);var h=Object(k.useTable)({columns:c,data:d}),m=h.getTableProps,p=h.getTableBodyProps,y=h.headerGroups,f=h.rows,g=h.prepareRow;return Object(A.jsxs)(O.a,Object(v.a)(Object(v.a)({},m()),{},{striped:!0,bordered:!0,hover:!0,children:[Object(A.jsx)("thead",{children:y.map((function(e){return Object(A.jsx)("tr",Object(v.a)(Object(v.a)({},e.getHeaderGroupProps()),{},{children:e.headers.map((function(e){return Object(A.jsx)("th",Object(v.a)(Object(v.a)({},e.getHeaderProps()),{},{children:e.render("Header")}))}))}))}))}),Object(A.jsx)("tbody",Object(v.a)(Object(v.a)({},p()),{},{children:f.map((function(e){return g(e),Object(A.jsx)("tr",Object(v.a)(Object(v.a)({},e.getRowProps()),{},{children:e.cells.map((function(e){return Object(A.jsx)("td",Object(v.a)(Object(v.a)({},e.getCellProps()),{},{children:e.render("Cell")}))}))}))}))}))]}))}i(395);var E=i(377),C=i(19),R=i(376),H=i(40);window.dfd=R;var D=function(){function e(){Object(c.a)(this,e),this.multipliers={}}return Object(l.a)(e,[{key:"normalize_stat",value:function(e,t){var i=e.mean(),n=Math.pow(10,Math.round(Math.log10(t/i))),o=[.2,.5,1,2,5],a=o.map((function(e){return[Math.abs(t-i*n*e),e]}));return n*=o[I(a)],this.multipliers[e.column_names]=n,e.mul(n)}}]),e}();var z,I=(z=function(e,t){return t[0]<e[0]?t:e},function(e){return e.map((function(e,t){return[e,t]})).reduce(z)[1]});window.env=new w;var q=[{team:"Vasco",goals:2},{team:"Botafogo",goals:5}],L={name:"team",max_health:"goals"},W=function(e,t){var i,n=[],o=Object(C.a)(e);try{for(o.s();!(i=o.n()).done;){var a=i.value,r={};for(var s in t){var c=t[s];r[s]=a[c]}n.push(r)}}catch(l){o.e(l)}finally{o.f()}return function(e){var t,i=new D,n=new H.a(e);for(var o in window.df=n,t={max_health:i.normalize_stat(n.max_health,100),name:n.name})t[o]=t[o].values;var a=(t=new H.a(t)).columns;return[t=(t=t.values).map((function(e){return function(e,t){for(var i={},n=0;n<e.length;++n)i[e[n]]=t[n];return i}(a,e)})),i.multipliers]}(n)}(q,L),G=Object(s.a)(W,2),J=G[0],N=G[1];var V=function(){var e=Object(n.useState)([]),t=Object(s.a)(e,2),i=t[0],o=t[1],a=Object(n.useState)(new Date),r=Object(s.a)(a,2),c=r[0],l=r[1];return window.env.game_state_callback=o,Object(n.useEffect)((function(){window.document.getElementById("canvas").innerHTML="",window.env.setup("canvas",J)}),[]),Object(A.jsxs)("div",{className:"App",children:[Object(A.jsx)(E.a,{onClick:function(){window.env=new w(o),window.document.getElementById("canvas").innerHTML="",window.env.setup("canvas",J),l(new Date)},children:" RESTART "}),Object(A.jsx)(T,{stats:q,attributes:J,stats_to_attributes:L,game_state:i,start_time:c,multipliers:N})]})},K=function(e){e&&e instanceof Function&&i.e(3).then(i.bind(null,564)).then((function(t){var i=t.getCLS,n=t.getFID,o=t.getFCP,a=t.getLCP,r=t.getTTFB;i(e),n(e),o(e),a(e),r(e)}))};r.a.render(Object(A.jsx)(o.a.StrictMode,{children:Object(A.jsx)(V,{})}),document.getElementById("root")),K()}},[[562,1,2]]]);
//# sourceMappingURL=main.d117ca68.chunk.js.map